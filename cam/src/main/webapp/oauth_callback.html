<!DOCTYPE html>
<html>
<head>
    <script src="js/tokenManager.js"></script>
    <script src="js/constants.js"></script>
    <script type="text/javascript">
        var callbackResponse = (document.URL).split("#")[1];
        var responseParameters = (callbackResponse).split("&");
        var parameterMap = [];
        for (var i = 0; i < responseParameters.length; i++) {
            parameterMap[responseParameters[i].split("=")[0]] = responseParameters[i].split("=")[1];
        }
        if (parameterMap.access_token !== undefined && parameterMap.access_token !== null) {
            var token = {
                    oauth: {
                        access_token: parameterMap.access_token,
                        expires_in: parameterMap.expires_in,
                        account_username: parameterMap.account_username
                }
            };
            console.log(JSON.stringify(token.oauth));
            TokenManager.setToken(token.oauth.access_token); //TODO Object
            window.location.href = CAM_URL;
        } else {
            alert("Problem authenticating");
        }
    </script>
</head>
<body>Redirecting...</body>
</html>